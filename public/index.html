<!DOCTYPE html>
<html>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
<title>Event App</title>

<script src="cordova.js"></script>
<script src="phonegap.js"></script>
</head>

<body class="pace-done">
 <h1>Hello</h1>

   <script>
      alert('load')
      var appUrl = 'https://fishry-app-services.azurewebsites.net/';
      var clientRef = new WindowsAzure.MobileServiceClient(appUrl);
      //alert(123);
      document.addEventListener("deviceready", onDeviceReady, false);
         function onDeviceReady() {
            alert(123)
            const push = PushNotification.init({
               android: {
               },
               browser: {
                  pushServiceURL: 'http://push.api.phonegap.com/v1/push'
               },
               ios: {
                  alert: "true",
                  badge: "true",
                  sound: "true"
               },
               windows: {}
            });

            push.on('registration', (data) => {
              alert(data);
            });

            push.on('notification', (data) => {
              alert(data);
            });

            push.on('error', (e) => {
               alert(e);
            });
            // alert(1)
            // FCMPlugin.onTokenRefresh(function (token) {
            //    alert(token);
            // });
            // //alert('ready');
            // //alert(PushNotification);
            // var push = PushNotification.init({ "android": { "senderID": "761913983169" } });
            // //alert(push);
            // push.on('registration', function (data) {
            //    //alert(data.registrationId);
            // });

            // push.on('notification', function (data) {
            //    //alert(data.title + " Message: " + data.message);
            // });

            // push.on('error', function (e) {
            //    //alert(e);
            // });
         }
   </script>
   
   <!--<script src="https://www.gstatic.com/firebasejs/4.6.1/firebase.js"></script>
   <script>
      // Initialize Firebase
      var config = {
         apiKey: "AIzaSyDzLcOnaVVxDaucTVeD53KKCjrGj3dgWlo",
         authDomain: " afes-2017.firebaseapp.com",
         databaseURL: "https://afes-2017.firebaseio.com",
         projectId: "afes-2017",
         storageBucket: "afes-2017.appspot.com",
         messagingSenderId: "584747194764"
      };
      firebase.initializeApp(config);
      // Retrieve Firebase Messaging object.
         const messaging = firebase.messaging();
         console.log(messaging)
         messaging.requestPermission()
               .then(function () {
                  console.log('Notification permission granted.');
                  // TODO(developer): Retrieve an Instance ID token for use with FCM.
                  // ...
               })
               .catch(function (err) {
                  console.log('Unable to get permission to notify.', err);
               });
         messaging.getToken()
               .then(function (currentToken) {
                  if (currentToken) {
                     sendTokenToServer(currentToken);
                     updateUIForPushEnabled(currentToken);
                  } else {
                     // Show permission request.
                     console.log('No Instance ID token available. Request permission to generate one.');
                     // Show permission UI.
                     updateUIForPushPermissionRequired();
                     setTokenSentToServer(false);
                  }
               })
               .catch(function (err) {
                  alert('An error occurred while retrieving token. ', err);
                  showToken('Error retrieving Instance ID token. ', err);
                  setTokenSentToServer(false);
               });
         var sendTokenToServer = function(token){
            alert(token)
         }
         var updateUIForPushPermissionRequired = function (token) {
               console.log(token)
            }
            var updateUIForPushEnabled = function (token) {
                  console.log(token)
               }
         messaging.onTokenRefresh(function () {
               messaging.getToken()
                  .then(function (refreshedToken) {
                     console.log('Token refreshed.');
                     // Indicate that the new Instance ID token has not yet been sent to the
                     // app server.
                     setTokenSentToServer(false);
                     // Send Instance ID token to app server.
                     sendTokenToServer(refreshedToken);
                     // ...
                  })
                  .catch(function (err) {
                    console.log('Unable to retrieve refreshed token ', err);
                     showToken('Unable to retrieve refreshed token ', err);
                  });
            });
            messaging.onMessage(function (payload) {
                  console.log("Message received. ", payload);
                  // ...
               });


   </script>-->


</body>

</html>